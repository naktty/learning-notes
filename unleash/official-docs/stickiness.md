# スティッキネス（Stickiness）

_スティッキネス_は、Unleashが同じユーザーに対して毎回同じ機能を提供することを保証する方法です。スティッキネスは、ユーザーの一部にのみ機能を表示したい場合や、ユーザーに機能のバリアントを提供したい場合に有用です。

## 計算方法

デフォルトでは、UnleashはユーザーIDとグループIDに基づいてスティッキネスを計算します。ユーザーIDが利用できない場合は、セッションIDにフォールバックします。これらの値をMurmurHashハッシュ関数を使用して0から100の間の数値にハッシュ化します。この数値が、ユーザーが特定の機能やバリアントを見るかどうかを決定します。このプロセスは決定論的であるため、同じユーザーは常に同じ数値を受け取ります。

ユーザーIDとセッションIDの両方が利用できない場合、計算はランダムな値を返し、スティッキネスは保証されません。

## 一貫性

ユーザーに割り当てられた数値は変更されないため、Unleashは他のパラメータが変更された場合でも、ユーザーが同じ機能を見続けることを保証します。

例えば：段階的ロールアウトのアクティベーション戦略を使用する場合、数値がロールアウト割合以下であるユーザーは機能を見ることになります。これは、ユーザーベースの割合を増やしても、同じユーザーが機能を見続けることを意味します。

## カスタムスティッキネス

**利用可能**: Enterprise プラン | **バージョン**: `4.0+` およびSDK互換性

段階的ロールアウト戦略や機能フラグのバリアントを使用する場合、ユーザーID以外のパラメータを使用してスティッキネスを計算することができます。具体的には、Unleash Contextの任意のフィールド（カスタムまたはその他）を使用できます。ただし、これらのフィールドに対してカスタムスティッキネスを有効にする必要があります。

### カスタムスティッキネスの有効化

フィールドのカスタムスティッキネスを有効にするには、UIのCreate Context画面に移動し、有効にしたいフィールドを見つけてください。フォームの下部に「Custom stickiness」オプションがあります。このフラグを有効にし、「Update」ボタンを押してコンテキストフィールドを更新してください。

![Create Context screen in the Unleash UI](https://docs.getunleash.io/assets/images/create-context-screen-4ced8005a835e7f4c5d59f57a1afd842.png)

## プロジェクトのデフォルトスティッキネス

**利用可能**: バージョン `5.0+`

Unleashの各プロジェクトは、独自のデフォルトスティッキネスコンテキストフィールドを持つことができます。プロジェクト内の機能に段階的ロールアウト戦略やバリアントを追加する際、Unleashは設定されたコンテキストフィールドを初期値として使用します。

カスタムスティッキネスオプションが有効になっているコンテキストフィールドのみが、デフォルトスティッキネスフィールドとして使用できます。

デフォルトのカスタムスティッキネスを指定しない場合、プロジェクトは「default」スティッキネスオプションを使用します。これは計算セクションで説明したように機能します。

プロジェクトのデフォルトスティッキネスは、プロジェクト作成時または後でプロジェクトを編集する際に設定できます。

![Edit Project screen](https://docs.getunleash.io/assets/images/edit-project-screen-4ced8005a835e7f4c5d59f57a1afd842.png)
